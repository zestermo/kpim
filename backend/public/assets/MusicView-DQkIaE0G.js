import{n as R,r as x,o as F,a as q,q as f,c as i,b as t,e as g,A as H,t as n,h as d,g as c,i as I,j as N,k as U,F as _,s as y,w as Y,f as z,v as L,T as O,m as a,y as T,x as $}from"./index-67zp9BDn.js";const A={class:"space-y-6"},Q={class:"flex items-center justify-between flex-wrap gap-4"},J={class:"text-gray-400"},K=["disabled"],W={class:"text-sm opacity-75"},X={key:0,class:"game-panel p-4 border-yellow-500/50"},Z={class:"text-yellow-400 flex items-center gap-2"},tt={key:1,class:"game-panel p-6"},et={class:"space-y-3"},st={class:"flex items-center gap-4"},ot={class:"text-2xl"},lt={class:"font-bold"},nt={class:"text-sm text-gray-400"},at={class:"text-right"},it={class:"text-kpop-pink-400 font-mono text-lg"},rt={key:2},dt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ct={class:"flex items-start justify-between mb-3"},ut={class:"flex items-center gap-3"},pt={class:"text-3xl"},gt={class:"font-bold text-lg"},mt={class:"text-sm text-gray-400"},vt={class:"grid grid-cols-2 gap-4 mb-4"},bt={class:"stat-bar"},xt={class:"text-right text-sm mt-1"},ft={class:"stat-bar"},_t={class:"text-right text-sm mt-1"},yt={class:"flex items-center justify-between pt-3 border-t border-gray-700"},ht={class:"text-sm text-gray-400"},kt={class:"text-kpop-gold-400 font-bold"},wt={key:3,class:"game-panel p-12 text-center"},St=["disabled"],Pt={class:"game-panel p-6 max-w-lg w-full mx-4"},Ct={class:"mb-6"},Mt={class:"grid grid-cols-2 gap-2"},Gt=["onClick"],It={class:"font-bold"},Nt={class:"text-xs text-gray-400"},Tt={class:"mb-6"},$t={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},jt=["onClick"],Bt={class:"text-lg"},Dt={class:"text-xs text-gray-400"},Vt={class:"mb-6"},Et={class:"flex gap-3"},Rt=["disabled"],Ft={key:0,class:"flex items-center justify-center gap-2"},qt={key:1},j=8e3,Yt={__name:"MusicView",setup(Ht){const l=R(),u=x(!1),p=x(null),m=x("pop"),v=x(""),h=[{value:"pop",label:"ðŸŽ¤ Pop",description:"Catchy and mainstream"},{value:"dance",label:"ðŸ’ƒ Dance",description:"Upbeat and energetic"},{value:"ballad",label:"ðŸŽ¹ Ballad",description:"Emotional and slow"},{value:"hiphop",label:"ðŸŽ§ Hip-Hop",description:"Rhythmic and bold"},{value:"rnb",label:"ðŸŽ· R&B",description:"Smooth and soulful"},{value:"edm",label:"ðŸŽ›ï¸ EDM",description:"Electronic beats"},{value:"rock",label:"ðŸŽ¸ Rock",description:"Powerful guitars"}];let k=null;F(async()=>{await Promise.all([l.fetchSongs(),l.fetchGroups()]),k=setInterval(async()=>{const o=l.songs.filter(e=>e.is_in_production);for(const e of o)await l.checkSongCompletion(e.id)},5e3)}),q(()=>{k&&clearInterval(k)});const S=f(()=>{var o;return l.groups.length>0&&((o=l.player)==null?void 0:o.money)>=j}),B=f(()=>p.value!==null),P=f(()=>l.songs.filter(o=>o.is_in_production)),w=f(()=>l.songs.filter(o=>o.is_completed));function C(){var o;p.value=((o=l.groups[0])==null?void 0:o.id)||null,m.value="pop",v.value="",u.value=!0}async function D(){(await l.produceSong(p.value,m.value,v.value||null)).success&&(u.value=!1)}function M(o){return h.find(e=>e.value===o)||h[0]}function V(o){const e=new Date,b=new Date(o),s=Math.max(0,b-e),r=Math.floor(s/6e4),E=Math.floor(s%6e4/1e3);return`${r}:${E.toString().padStart(2,"0")}`}function G(o){return l.groups.find(e=>e.id===o)}return(o,e)=>{const b=U("router-link");return a(),i("div",A,[t("div",Q,[t("div",null,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold"},"Music Production",-1)),t("p",J,n(w.value.length)+" songs ready for promotion",1)]),t("button",{onClick:C,class:"btn-primary flex items-center gap-2",disabled:!S.value},[e[4]||(e[4]=t("span",null,"ðŸŽµ",-1)),e[5]||(e[5]=d(" Produce New Song ",-1)),t("span",W,"(ðŸ’° "+n(j.toLocaleString())+")",1)],8,K)]),c(l).groups.length===0?(a(),i("div",X,[t("p",Z,[e[7]||(e[7]=t("span",null,"âš ï¸",-1)),e[8]||(e[8]=d(" You need a group to produce music. ",-1)),I(b,{to:"/groups",class:"underline"},{default:N(()=>[...e[6]||(e[6]=[d("Form a group first",-1)])]),_:1})])])):g("",!0),P.value.length>0?(a(),i("div",tt,[e[10]||(e[10]=t("h2",{class:"text-lg font-bold mb-4 flex items-center gap-2"},[t("span",{class:"animate-pulse"},"â³"),d(" In Production ")],-1)),t("div",et,[(a(!0),i(_,null,y(P.value,s=>{var r;return a(),i("div",{key:s.id,class:"flex items-center justify-between p-4 bg-gray-800/50 rounded-xl"},[t("div",st,[t("div",ot,n(M(s.genre).label.split(" ")[0]),1),t("div",null,[t("p",lt,n(s.title),1),t("p",nt,n((r=G(s.group_id))==null?void 0:r.name),1)])]),t("div",at,[t("div",it,n(V(s.production_ends_at)),1),e[9]||(e[9]=t("div",{class:"text-xs text-gray-400"},"remaining",-1))])])}),128))])])):g("",!0),w.value.length>0?(a(),i("div",rt,[e[15]||(e[15]=t("h2",{class:"text-lg font-bold mb-4 flex items-center gap-2"},[t("span",null,"âœ…"),d(" Ready for Promotion ")],-1)),t("div",dt,[(a(!0),i(_,null,y(w.value,s=>{var r;return a(),i("div",{key:s.id,class:"game-panel p-5"},[t("div",ct,[t("div",ut,[t("div",pt,n(M(s.genre).label.split(" ")[0]),1),t("div",null,[t("h3",gt,n(s.title),1),t("p",mt,n((r=G(s.group_id))==null?void 0:r.name),1)])])]),t("div",vt,[t("div",null,[e[11]||(e[11]=t("div",{class:"text-xs text-gray-400 mb-1"},"Quality",-1)),t("div",bt,[t("div",{class:"stat-bar-fill bg-gradient-to-r from-blue-500 to-cyan-500",style:T({width:`${s.quality}%`})},null,4)]),t("div",xt,n(s.quality),1)]),t("div",null,[e[12]||(e[12]=t("div",{class:"text-xs text-gray-400 mb-1"},"Hype",-1)),t("div",ft,[t("div",{class:"stat-bar-fill bg-gradient-to-r from-orange-500 to-red-500",style:T({width:`${s.hype}%`})},null,4)]),t("div",_t,n(s.hype),1)])]),t("div",yt,[t("div",ht,[e[13]||(e[13]=d(" Promo Power: ",-1)),t("span",kt,n(s.promotion_power),1)]),I(b,{to:"/promotions",class:"btn-primary text-sm py-2 px-4"},{default:N(()=>[...e[14]||(e[14]=[d(" Promote ðŸ“¢ ",-1)])]),_:1})])])}),128))])])):g("",!0),c(l).songs.length===0&&c(l).groups.length>0?(a(),i("div",wt,[e[16]||(e[16]=t("div",{class:"text-6xl mb-4"},"ðŸŽµ",-1)),e[17]||(e[17]=t("h2",{class:"text-xl font-bold mb-2"},"No Songs Yet",-1)),e[18]||(e[18]=t("p",{class:"text-gray-400 mb-6"},"Produce your first song to start gaining fans!",-1)),t("button",{onClick:C,class:"btn-primary",disabled:!S.value}," Produce Your First Song ",8,St)])):g("",!0),(a(),H(O,{to:"body"},[u.value?(a(),i("div",{key:0,class:"modal-backdrop",onClick:e[2]||(e[2]=Y(s=>u.value=!1,["self"]))},[t("div",Pt,[e[23]||(e[23]=t("h2",{class:"text-2xl font-bold mb-6 text-center"},"ðŸŽµ Produce New Song",-1)),t("div",Ct,[e[19]||(e[19]=t("label",{class:"block text-sm text-gray-400 mb-2"},"Select Group",-1)),t("div",Mt,[(a(!0),i(_,null,y(c(l).groups,s=>(a(),i("button",{key:s.id,onClick:r=>p.value=s.id,class:$(["p-3 rounded-xl border-2 transition-all text-left",p.value===s.id?"border-kpop-pink-500 bg-kpop-pink-500/10":"border-gray-600 hover:border-gray-500"])},[t("div",It,n(s.name),1),t("div",Nt,"â­ "+n(s.average_star_power),1)],10,Gt))),128))])]),t("div",Tt,[e[20]||(e[20]=t("label",{class:"block text-sm text-gray-400 mb-2"},"Genre",-1)),t("div",$t,[(a(),i(_,null,y(h,s=>t("button",{key:s.value,onClick:r=>m.value=s.value,class:$(["p-2 rounded-xl border-2 transition-all text-center",m.value===s.value?"border-kpop-pink-500 bg-kpop-pink-500/10":"border-gray-600 hover:border-gray-500"])},[t("div",Bt,n(s.label.split(" ")[0]),1),t("div",Dt,n(s.label.split(" ").slice(1).join(" ")),1)],10,jt)),64))])]),t("div",Vt,[e[21]||(e[21]=t("label",{class:"block text-sm text-gray-400 mb-2"},[d(" Song Title "),t("span",{class:"text-gray-500"},"(optional - will auto-generate)")],-1)),z(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"text",class:"input-field",placeholder:"Enter a song title...",maxlength:"100"},null,512),[[L,v.value]])]),t("div",Et,[t("button",{onClick:e[1]||(e[1]=s=>u.value=!1),class:"btn-secondary flex-1"}," Cancel "),t("button",{onClick:D,class:"btn-primary flex-1",disabled:!B.value||c(l).loading},[c(l).loading?(a(),i("span",Ft,[...e[22]||(e[22]=[t("span",{class:"spinner"},null,-1),d(" Starting... ",-1)])])):(a(),i("span",qt,"Start Production ðŸŽ¶"))],8,Rt)])])])):g("",!0)]))])}}};export{Yt as default};
