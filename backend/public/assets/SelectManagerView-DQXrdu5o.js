import{n as P,u as M,r as x,o as C,p as N,q as F,c as r,b as e,e as f,t as i,F as h,s as L,g as V,h as B,l as I,m as n,x as q}from"./index-67zp9BDn.js";const A={class:"min-h-screen py-8 px-4"},D={class:"max-w-4xl mx-auto"},T={class:"game-panel p-4 mb-6 border-yellow-500/50"},$={class:"flex items-center justify-between flex-wrap gap-4"},j={class:"text-sm text-gray-400"},R={key:0},Y={key:0,class:"game-panel p-4 mb-6 border-red-500/50"},z={class:"text-red-400"},E={key:1,class:"text-center py-12"},G={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8"},Q=["onClick"],U={class:"text-xl font-bold text-center mb-2"},H={class:"bg-kpop-purple-500/20 rounded-lg px-4 py-2 mb-3 text-center"},J={class:"text-sm text-gray-300"},K={class:"ml-2 font-bold text-kpop-gold-400"},O={class:"text-sm text-gray-400 text-center italic"},W={key:0,class:"mt-4 text-center"},X={class:"text-center"},Z=["disabled"],ee={key:0,class:"flex items-center gap-2"},te={key:1},re={__name:"SelectManagerView",setup(se){I();const m=P(),l=M(),a=x(null),d=x(!1),v=x(!0),c=x("");C(async()=>{var o;try{const s=(await N.get("/me")).data.data.user;if(l.user=s,m.setPlayer(s.playerProfile),(o=s==null?void 0:s.playerProfile)!=null&&o.manager_id){console.log("Manager already selected, redirecting to dashboard"),window.location.href="/dashboard";return}}catch(t){console.error("Failed to check user:",t),c.value="Failed to load user data"}v.value=!1,await m.fetchManagers()});async function y(){var o;if(!(!a.value||d.value)){d.value=!0,c.value="";try{const t=await m.selectManager(a.value.id);t.success?((o=l.user)!=null&&o.playerProfile&&(l.user.playerProfile.manager_id=a.value.id,l.user.playerProfile.manager=a.value),window.location.href="/dashboard"):c.value=t.error||"Failed to select manager"}catch(t){c.value=t.message||"An error occurred"}d.value=!1}}function b(){l.logout(),window.location.href="/login"}function k(){window.location.href="/dashboard"}const w={promotion_boost:"ðŸ“¢ Promotion Power",training_speed:"âš¡ Training Speed",virality_chance:"ðŸ”¥ Viral Chance",award_chance:"ðŸ† Award Luck",scouting_quality:"ðŸ” Scouting Quality"};function S(o){return`+${Math.round(o.bonus_value*100)}%`}const _=F(()=>{var o,t,s,u,p,g;return{hasUser:!!l.user,hasProfile:!!((o=l.user)!=null&&o.playerProfile),managerId:(s=(t=l.user)==null?void 0:t.playerProfile)==null?void 0:s.manager_id,managerName:(g=(p=(u=l.user)==null?void 0:u.playerProfile)==null?void 0:p.manager)==null?void 0:g.name}});return(o,t)=>(n(),r("div",A,[e("div",D,[e("div",T,[e("div",$,[e("div",j,[e("p",null,"Manager ID: "+i(_.value.managerId||"None"),1),_.value.managerName?(n(),r("p",R,"Manager: "+i(_.value.managerName),1)):f("",!0)]),e("div",{class:"flex gap-2"},[e("button",{onClick:k,class:"btn-secondary text-sm py-2 px-4"}," Force â†’ Dashboard "),e("button",{onClick:b,class:"text-red-400 hover:text-red-300 text-sm py-2 px-4"}," Logout & Reset ")])])]),c.value?(n(),r("div",Y,[e("p",z,i(c.value),1)])):f("",!0),v.value?(n(),r("div",E,[...t[0]||(t[0]=[e("div",{class:"spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-400"},"Checking your profile...",-1)])])):(n(),r(h,{key:2},[t[4]||(t[4]=e("div",{class:"text-center mb-8"},[e("h1",{class:"font-display text-3xl text-transparent bg-clip-text bg-gradient-to-r from-kpop-pink-400 to-kpop-purple-400 mb-2"}," Choose Your Manager "),e("p",{class:"text-gray-400"},"Your manager will guide your agency with unique bonuses")],-1)),e("div",G,[(n(!0),r(h,null,L(V(m).managers,s=>{var u,p,g;return n(),r("div",{key:s.id,class:q(["game-panel p-6 cursor-pointer transition-all duration-300",{"ring-2 ring-kpop-pink-500 scale-105":((u=a.value)==null?void 0:u.id)===s.id,"hover:border-kpop-purple-400":((p=a.value)==null?void 0:p.id)!==s.id}]),onClick:ae=>a.value=s},[t[2]||(t[2]=e("div",{class:"w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-kpop-pink-500/20 to-kpop-purple-500/20 flex items-center justify-center text-4xl"}," ðŸ‘” ",-1)),e("h3",U,i(s.name),1),e("div",H,[e("span",J,i(w[s.bonus_type]),1),e("span",K,i(S(s)),1)]),e("p",O,' "'+i(s.flavor_text)+'" ',1),((g=a.value)==null?void 0:g.id)===s.id?(n(),r("div",W,[...t[1]||(t[1]=[e("span",{class:"text-kpop-pink-400 font-medium"},"âœ“ Selected",-1)])])):f("",!0)],10,Q)}),128))]),e("div",X,[e("button",{onClick:y,class:"btn-primary text-lg px-12",disabled:!a.value||d.value},[d.value?(n(),r("span",ee,[...t[3]||(t[3]=[e("span",{class:"spinner"},null,-1),B(" Selecting... ",-1)])])):(n(),r("span",te,i(a.value?`Start with ${a.value.name}`:"Select a Manager"),1))],8,Z)])],64))])]))}};export{re as default};
